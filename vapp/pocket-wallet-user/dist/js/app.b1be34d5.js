(function(){var e={9639:function(e,t,n){"use strict";var r=n(9242),a=n(3396);const s={key:0},o={key:1};function l(e,t,n,r,l,c){const i=(0,a.up)("AppUser");return e.adminMode?((0,a.wg)(),(0,a.iD)("div",s," coucou ")):((0,a.wg)(),(0,a.iD)("div",o,[(0,a.Wm)(i)]))}const c={class:"flex flex-col h-full"},i=(0,a._)("nav",{class:"flex flex-row flex-wrap h-16 bg-slate-700"},[(0,a._)("ul",{class:"grow flex flex-row flex-wrap h-16"},[(0,a._)("li",{class:"flex-initial text-slate-300 ml-8 self-center"},[(0,a._)("h1",null,"Pocket wallet")])]),(0,a._)("div",{class:"flex-shrink overflow-visible p-2 z-30"})],-1),d={class:"h-full"},u={key:0,class:"flex flex-row h-full"},p=(0,a._)("div",{class:"flex-initial p-2 dark:bg-slate-800"},[(0,a._)("aside")],-1),f={class:"flex-auto h-full flex flex-col p-4"},m={key:0,class:"flex-initial bg-red-500/25 text-red-100"},w=(0,a._)("p",null,"This demo project is not expected to be deployed in a mainnet",-1),y=[w],h=(0,a._)("main",{class:"m-auto"},null,-1),_={key:0,class:"modal"};function v(e,t,n,r,s,o){const l=(0,a.up)("FirstAccess");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",c,[i,(0,a._)("div",d,[o.account&&e.is_ready?((0,a.wg)(),(0,a.iD)("div",u,[p,(0,a._)("div",f,[o.is_test_network?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",m,y)),h])])):(0,a.kq)("",!0)])]),e.displayFirstAccess?((0,a.wg)(),(0,a.iD)("div",_,[(0,a.Wm)(l)])):(0,a.kq)("",!0)],64)}var g=n(7139);const k={key:0},b={key:0},A={key:1},x={key:2},C=(0,a._)("h2",null,"Bonjour !",-1),W=(0,a.Uk)(" Don't have a Pocket Wallet yet ? "),O=(0,a._)("p",null," Already have one ? ",-1),D={key:1},$={key:0},M=(0,a._)("div",null,null,-1),P=(0,a._)("p",null," This is your wallet address. Send it to your parent to finalize the creation of your pocket wallet ",-1);function S(e,t,n,r,s,o){const l=(0,a.up)("EnterPin");return o.wallet_address?((0,a.wg)(),(0,a.iD)("div",D,[o.contract_address?(0,a.kq)("",!0):((0,a.wg)(),(0,a.iD)("div",$,[M,P,(0,a._)("span",null,(0,g.zw)(o.wallet_address),1)]))])):((0,a.wg)(),(0,a.iD)("div",k,[!0===e.newAccount?((0,a.wg)(),(0,a.iD)("div",b,[(0,a.Wm)(l,{onCanCancel:e=>!1,onOk:o.onNewAccountPinEntered,onCancel:o.onNewAccountCancel},null,8,["onOk","onCancel"])])):!1===e.newAccount?((0,a.wg)(),(0,a.iD)("div",A," TODO : restore account from mnemonic or encrypted file ? ")):((0,a.wg)(),(0,a.iD)("div",x,[C,(0,a._)("p",null,[W,(0,a._)("button",{onClick:t[0]||(t[0]=(...e)=>o.onNewAccount&&o.onNewAccount(...e))},"Create my pocket")]),O,(0,a._)("button",{onClick:t[1]||(t[1]=(...e)=>o.onRestoreAccount&&o.onRestoreAccount(...e))},"Restore my pocket")]))]))}function T(e,t,n,s,o,l){return(0,a.wg)(),(0,a.iD)("div",null,[(0,a.wy)((0,a._)("input",{type:"password","onUpdate:modelValue":t[0]||(t[0]=t=>e.pin=t)},null,512),[[r.nr,e.pin]]),(0,a._)("button",{onClick:t[1]||(t[1]=(...e)=>l.onOk&&l.onOk(...e))},"OK"),(0,a.wy)((0,a._)("button",{onClick:t[2]||(t[2]=(...e)=>l.onCancel&&l.onCancel(...e))},"Cancel",512),[[r.F8,n.canCancel]])])}var F={name:"FirstAccess",data:function(){return{pin:String}},props:{canCancel:Boolean},computed:{},components:{},emits:{ok(){return!0},cancel:()=>!0},methods:{onOk(e){e.preventDefault(),this.$emit("ok",this.$data.pin)},onCancel(e){e.preventDefault(),this.$emit("cancel")}},async mounted(){this.$data.pin=""}},N=n(89);const U=(0,N.Z)(F,[["render",T]]);var I=U,j={name:"FirstAccess",data:function(){return{newAccount:null,walletAddress:""}},props:{},computed:{wallet_address(){return this.$store.getters.wallet_address},contract_address(){return this.$store.getters.contract_address}},components:{EnterPin:I},emits:{},methods:{onNewAccount(e){return e.preventDefault(),this.$data.newAccount=!0,!0},onRestoreAccount(e){return e.preventDefault(),this.$data.newAccount=!1,!0},async onNewAccountPinEntered(e){await this.$store.dispatch("generateWallet",e)},onNewAccountCancel(){return!1}},async mounted(){}};const E=(0,N.Z)(j,[["render",S]]);var R=E,Z={name:"AppUser",data:function(){return{displayFirstAccess:!0}},props:{},computed:{account(){return this.$store.getters.account},network(){return this.$store.getters.network},factory_address(){return this.$store.getters.factory_address},wallet_address(){return this.$store.getters.wallet_address},error(){return this.$store.getters.error},is_test_network(){switch(this.$store.getters.network){case"0x2":case"0x3":case"0x4":case"0x5":case"0x2a":case"0x539":return!0;default:return!1}}},components:{FirstAccess:R},methods:{},emits:{},async mounted(){this.$store.dispatch("loadWallet"),this.displayFirstAccess=null==this.$store.getters.contract_address}};const q=(0,N.Z)(Z,[["render",v]]);var B=q,K={name:"App",data:function(){return{adminMode:!1}},props:{},computed:{},components:{AppUser:B},methods:{async mounted(){}},emits:{}};const z=(0,N.Z)(K,[["render",l]]);var H=z,J=n(65),G=n(6796),V=n(1194),Y=n(6661),L=n(6781),Q=n(594),X=JSON.parse('{"Mt":[{"inputs":[],"stateMutability":"nonpayable","type":"constructor"},{"inputs":[{"internalType":"address","name":"controller","type":"address"}],"name":"setController","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"user","type":"address"}],"name":"setUser","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"user","type":"address"}],"name":"removeUser","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"user","type":"address"}],"name":"createPocketWallet","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"user","type":"address"}],"name":"getUserContractAddress","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function","constant":true}]}'),ee=new J.ZP.Store({state:{account:null,network:null,balance:null,factory_address:"0xd1476bC527eEC759a03fd9cb5A0c227B700D49d3",wallet_address:null,wallet_mnemonic:null,wallet_private_key:null,contract_address:null},getters:{account:e=>e.account,network:e=>e.network,error:e=>e.error,balance:e=>e.balance,factory_address:e=>e.factory_address,wallet_address:e=>e.wallet_address,contract_address:e=>e.contract_address},mutations:{setAccount(e,t){e.account=t},setNetwork(e,t){e.network=t},setError(e,t){e.error=t},setBalance(e,t){e.balance=t},setWalletAddress(e,t){e.wallet_address=t},setWalletMnemonic(e,t){e.wallet_mnemonic=t},setWalletPrivateKey(e,t){e.wallet_private_key=t},setContractAddress(e,t){e.contract_address=t}},actions:{async getFactory(e,t){return new G.CH(this.getters.factory_address,X.Mt,t)},async generateWallet({commit:e}){console.log("Generating your wallet");const t=V.w5.createRandom();e("setWalletAddress",t.address),e("setWalletMnemonic",t.mnemonic.phrase),localStorage.setItem("wallet_address",t.address),console.log(`Wallet address : ${t.address}`),localStorage.setItem("wallet_mnemonic",t.mnemonic.phrase)},async restoreWallet({commit:e},t){const n=V.w5.fromMnemonic(t);e("setWalletAddress",n.address),e("setWalletMnemonic",t),e("setWalletPrivateKey",n.privateKey),localStorage.setItem("wallet_address",n.address),localStorage.setItem("wallet_mnemonic",n.mnemonic.phrase)},async loadWallet({commit:e}){let t=localStorage.getItem("wallet_mnemonic"),n=localStorage.getItem("wallet_address"),r=localStorage.getItem("contract_address");if(L.xh(t)){var a=V.w5.fromMnemonic(t);if(Q.UJ(n)||(console.warn("Invalid loaded wallet address. The wallet address has been rebuilt from the mnemonic"),n=a.address),e("setWalletAddress",n),e("setWalletMnemonic",t),!r){console.log("Searching for PocketWallet contract for the user ...");var s=Y.yl("http://localhost:8545"),o=await this.dispatch("getFactory",s);return r=await o.getUserContractAddress(n),"0x0000000000000000000000000000000000000000"!=r?(console.log(`PocketWallet contract found : ${r}`),e("setContractAddress",r)):console.log("No PocketWallet contract found for this user"),!0}}else console.log("Invalid mnemonic")}}});(0,r.ri)(H).use(ee).mount("#app")},6601:function(){}},t={};function n(r){var a=t[r];if(void 0!==a)return a.exports;var s=t[r]={id:r,loaded:!1,exports:{}};return e[r].call(s.exports,s,s.exports,n),s.loaded=!0,s.exports}n.m=e,function(){n.amdO={}}(),function(){var e=[];n.O=function(t,r,a,s){if(!r){var o=1/0;for(d=0;d<e.length;d++){r=e[d][0],a=e[d][1],s=e[d][2];for(var l=!0,c=0;c<r.length;c++)(!1&s||o>=s)&&Object.keys(n.O).every((function(e){return n.O[e](r[c])}))?r.splice(c--,1):(l=!1,s<o&&(o=s));if(l){e.splice(d--,1);var i=a();void 0!==i&&(t=i)}}return t}s=s||0;for(var d=e.length;d>0&&e[d-1][2]>s;d--)e[d]=e[d-1];e[d]=[r,a,s]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.nmd=function(e){return e.paths=[],e.children||(e.children=[]),e}}(),function(){var e={143:0};n.O.j=function(t){return 0===e[t]};var t=function(t,r){var a,s,o=r[0],l=r[1],c=r[2],i=0;if(o.some((function(t){return 0!==e[t]}))){for(a in l)n.o(l,a)&&(n.m[a]=l[a]);if(c)var d=c(n)}for(t&&t(r);i<o.length;i++)s=o[i],n.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return n.O(d)},r=self["webpackChunkvapp"]=self["webpackChunkvapp"]||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))}();var r=n.O(void 0,[998],(function(){return n(9639)}));r=n.O(r)})();
//# sourceMappingURL=app.b1be34d5.js.map